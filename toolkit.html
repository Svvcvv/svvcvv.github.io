<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>网页实用工具集</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; max-width: 1000px; margin: 20px auto; padding: 0 20px; }
        .tabs { display: flex; gap: 5px; flex-wrap: wrap; border-bottom: 2px solid #e0e0e0; margin-bottom: 20px; }
        .tab { padding: 10px 20px; cursor: pointer; background: #f5f5f5; border: 1px solid #e0e0e0; border-radius: 4px 4px 0 0; transition: 0.3s; }
        .tab.active { background: #2196F3; color: white; border-color: #2196F3; transform: translateY(2px); }
        .tool-section { display: none; padding: 20px; background: #f8f9fa; border-radius: 8px; }
        .tool-section.active { display: block; }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 8px; font-weight: 500; color: #333; }
        textarea, input, select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; font-size: 14px; }
        textarea { min-height: 100px; resize: vertical; }
        .button-group { margin: 15px 0; display: flex; gap: 10px; flex-wrap: wrap; }
        button { padding: 10px 20px; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; transition: 0.3s; }
        button:hover { opacity: 0.9; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .result-box { margin: 15px 0; padding: 15px; background: white; border-radius: 4px; border: 1px solid #eee; }
        .code-highlight { padding: 15px; background: #2d2d2d; border-radius: 4px; margin: 10px 0; }
        .code-highlight pre { margin: 0; color: #ccc; }
        .param-item { margin: 5px 0; padding: 12px; background: #e3f2fd; border-radius: 4px; }
        .csv-error { color: #ff9800; padding: 15px; background: #fff3e0; border-radius: 4px; margin: 10px 0; }
        #markdown-preview { padding: 15px; background: white; border: 1px solid #eee; border-radius: 4px; margin-top: 10px; line-height: 1.6; }
    </style>
    <!-- 依赖库 -->
    <script src="js/qrcode.js"></script>
    <script src="js/marked.min.js"></script>
    <link rel="stylesheet" href="js/prism.css">
    <script src="js/prism.js"></script>
</head>
<body>
    <h1>网页实用工具集</h1>
    
    <div class="tabs">
        <div class="tab active" data-target="url-tool">URL编解码</div>
        <div class="tab" data-target="base64-tool">Base64编解码</div>
        <div class="tab" data-target="unicode-tool">Unicode转换</div>
        <div class="tab" data-target="color-tool">颜色格式转换</div>
        <div class="tab" data-target="timestamp-tool">时间戳转换</div>
        <div class="tab" data-target="string-tool">字符串处理</div>
        <div class="tab" data-target="regex-tool">正则测试</div>
        <div class="tab" data-target="json-tool">JSON格式化</div>
        <div class="tab" data-target="markdown-tool">Markdown预览</div>
        <div class="tab" data-target="csv-tool">CSV转JSON</div>
        <div class="tab" data-target="code-tool">代码高亮</div>
        <div class="tab" data-target="urlparam-tool">URL参数解析</div>
    </div>

    <!-- 1. URL编解码工具（原有） -->
    <div class="tool-section active" id="url-tool">
        <div class="input-group">
            <label>输入内容：</label>
            <textarea id="url-input" placeholder="输入需要处理的文本"></textarea>
        </div>
        <div class="button-group">
            <button onclick="urlEncode()">URL编码</button>
            <button onclick="urlDecode()">URL解码</button>
            <button onclick="copyResult('url-result')">复制结果</button>
        </div>
        <div class="input-group">
            <label>处理结果：</label>
            <textarea id="url-result" readonly></textarea>
        </div>
    </div>

    <!-- 2. Base64编解码工具（原有） -->
    <div class="tool-section" id="base64-tool">
        <div class="input-group">
            <label>输入内容：</label>
            <textarea id="base64-input" placeholder="输入需要处理的文本"></textarea>
        </div>
        <div class="button-group">
            <button onclick="base64Encode()">Base64编码</button>
            <button onclick="base64Decode()">Base64解码</button>
            <button onclick="copyResult('base64-result')">复制结果</button>
        </div>
        <div class="input-group">
            <label>处理结果：</label>
            <textarea id="base64-result" readonly></textarea>
        </div>
    </div>


    <!-- 4. Unicode转换工具（原有） -->
    <div class="tool-section" id="unicode-tool">
        <div class="input-group">
            <label>输入内容：</label>
            <textarea id="unicode-input" placeholder="输入要转换的文本（如：你好 或 \u4f60\u597d）"></textarea>
        </div>
        <div class="button-group">
            <button onclick="textToUnicode()">转Unicode转义</button>
            <button onclick="unicodeToText()">Unicode转原文</button>
            <button onclick="copyResult('unicode-result')">复制结果</button>
        </div>
        <div class="input-group">
            <label>处理结果：</label>
            <textarea id="unicode-result" readonly></textarea>
        </div>
    </div>

    <!-- 5. 颜色格式转换工具（原有） -->
    <div class="tool-section" id="color-tool">
        <div class="input-group">
            <label>输入颜色值（支持#hex/RGB/HSL）：</label>
            <input type="text" id="color-input" placeholder="示例：#ff0033 / rgb(255,0,51) / hsl(348,100%,50%)">
        </div>
        <div class="button-group">
            <button onclick="convertColor()">转换所有格式</button>
        </div>
        <div class="input-group">
            <label>十六进制格式：</label>
            <input type="text" id="color-hex" readonly>
            <span class="color-preview" style="width: 50px; height: 30px; border: 1px solid #ddd; border-radius: 4px; display: inline-block; vertical-align: middle;" id="color-hex-preview"></span>
        </div>
        <div class="input-group">
            <label>RGB格式：</label>
            <input type="text" id="color-rgb" readonly>
        </div>
        <div class="input-group">
            <label>HSL格式：</label>
            <input type="text" id="color-hsl" readonly>
        </div>
    </div>

    <!-- 6. 时间戳转换工具（原有） -->
    <div class="tool-section" id="timestamp-tool">
        <div class="input-group">
            <label>输入时间戳（毫秒/秒）：</label>
            <input type="text" id="timestamp-input" placeholder="示例：1719235200000 或 1719235200">
        </div>
        <div class="button-group">
            <button onclick="timestampToDate()">转日期时间</button>
            <button onclick="dateToTimestamp()">当前时间转时间戳</button>
            <button onclick="copyResult('timestamp-result')">复制结果</button>
        </div>
        <div class="input-group">
            <label>转换结果：</label>
            <input type="text" id="timestamp-result" readonly>
        </div>
    </div>

    <!-- 7. 字符串处理工具（原有） -->
    <div class="tool-section" id="string-tool">
        <div class="input-group">
            <label>输入字符串：</label>
            <textarea id="string-input" placeholder="输入需要处理的文本"></textarea>
        </div>
        <div class="button-group">
            <button onclick="strToUpper()">转全大写</button>
            <button onclick="strToLower()">转全小写</button>
            <button onclick="strCapitalize()">首字母大写</button>
            <button onclick="strTrim()">去前后空格</button>
            <button onclick="strTrimAll()">去所有空格</button>
            <button onclick="strReverse()">反转字符串</button>
            <button onclick="copyResult('string-result')">复制结果</button>
        </div>
        <div class="input-group">
            <label>处理结果：</label>
            <textarea id="string-result" readonly></textarea>
        </div>
    </div>

    <!-- 8. 正则表达式测试工具（原有） -->
    <div class="tool-section" id="regex-tool">
        <div class="input-group">
            <label>正则表达式：</label>
            <input type="text" id="regex-pattern" placeholder="输入正则表达式（如：\d+）">
        </div>
        <div class="input-group">
            <label>匹配标志：</label>
            <input type="text" id="regex-flags" placeholder="可选标志（如：igm）" value="igm">
        </div>
        <div class="input-group">
            <label>测试字符串：</label>
            <textarea id="regex-input" placeholder="输入要测试的文本"></textarea>
        </div>
        <div class="button-group">
            <button onclick="testRegex()">执行匹配</button>
        </div>
        <div id="regex-result" class="result-box"></div>
    </div>

    <!-- 9. JSON格式化工具（原有） -->
    <div class="tool-section" id="json-tool">
        <div class="input-group">
            <label>输入JSON（压缩/未格式化）：</label>
            <textarea id="json-input" placeholder="输入JSON字符串"></textarea>
        </div>
        <div class="button-group">
            <button onclick="formatJSON()">格式化JSON</button>
            <button onclick="copyResult('json-result')">复制结果</button>
        </div>
        <div class="input-group">
            <label>格式化结果：</label>
            <div id="json-result" class="result-box"></div>
        </div>
    </div>

    <!-- 10. Markdown预览工具（原有） -->
    <div class="tool-section" id="markdown-tool">
        <div class="input-group">
            <label>输入Markdown：</label>
            <textarea id="markdown-input" placeholder="输入Markdown文本" oninput="previewMarkdown()"></textarea>
        </div>
        <div class="input-group">
            <label>实时预览：</label>
            <div id="markdown-preview" class="result-box"></div>
        </div>
    </div>

    <!-- 11. 新增：CSV转JSON工具 -->
    <div class="tool-section" id="csv-tool">
        <div class="input-group">
            <label>输入CSV内容（第一行为表头）：</label>
            <textarea id="csv-input" placeholder="示例：\n姓名,年龄,城市\n张三,25,北京\n李四,30,上海"></textarea>
        </div>
        <div class="input-group">
            <label>分隔符：</label>
            <select id="csv-delimiter">
                <option value=",">逗号(,)</option>
                <option value=";">分号(;)</option>
                <option value="\t">制表符(\\t)</option>
            </select>
        </div>
        <div class="button-group">
            <button onclick="csvToJson()">转换为JSON</button>
            <button onclick="copyResult('csv-result')">复制结果</button>
        </div>
        <div class="input-group">
            <label>转换结果：</label>
            <textarea id="csv-result" readonly class="result-box"></textarea>
        </div>
    </div>

    <!-- 12. 新增：代码高亮工具 -->
    <div class="tool-section" id="code-tool">
        <div class="input-group">
        Power by prism
            <label>选择语言：</label>
            <select id="code-language">
                <option value="javascript">JavaScript</option>
                <option value="python">Python</option>
                <option value="html">HTML</option>
                <option value="css">CSS</option>
                <option value="clike">C-like</option>
                <option value="c">C</option>
                <option value="cpp">C++</option>
                <option value="java">Java</option>
            </select>
        </div>
        <div class="input-group">
            <label>输入代码：</label>
            <textarea id="code-input" placeholder="输入需要高亮的代码"></textarea>
        </div>
        <div class="button-group">
            <button onclick="highlightCode()">生成高亮代码</button>
        </div>
        <div class="input-group">
            <label>高亮结果：</label>
            <div id="code-result" class="code-highlight"></div>
        </div>
    </div>

    <!-- 13. 新增：URL参数解析工具 -->
    <div class="tool-section" id="urlparam-tool">
        <div class="input-group">
            <label>输入完整URL：</label>
            <input type="text" id="urlparam-input" placeholder="示例：https://example.com?name=张三&age=25">
        </div>
        <div class="button-group">
            <button onclick="parseUrlParams()">解析参数</button>
        </div>
        <div class="input-group">
            <label>解析结果：</label>
            <div id="urlparam-result" class="result-box"></div>
        </div>
    </div>

    <script>
        // 选项卡切换逻辑
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tool-section').forEach(s => s.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.target).classList.add('active');
            });
        });

        // 原有功能函数（保持不变）...
function urlEncode() {
            const input = document.getElementById('url-input').value;
            document.getElementById('url-result').value = encodeURIComponent(input);
        }

        // URL解码
        function urlDecode() {
            const input = document.getElementById('url-input').value;
            try {
                document.getElementById('url-result').value = decodeURIComponent(input);
            } catch (e) {
                alert('无效的URL编码格式');
            }
        }

        // Base64编码（处理Unicode）
        function base64Encode() {
            const input = document.getElementById('base64-input').value;
            const utf8Bytes = new TextEncoder().encode(input);
            document.getElementById('base64-result').value = btoa(String.fromCharCode(...utf8Bytes));
        }

        // Base64解码（处理Unicode）
        function base64Decode() {
            const input = document.getElementById('base64-input').value;
            try {
                const binaryString = atob(input);
                const bytes = new Uint8Array(binaryString.length);
                for (let i = 0; i < binaryString.length; i++) {
                    bytes[i] = binaryString.charCodeAt(i);
                }
                document.getElementById('base64-result').value = new TextDecoder().decode(bytes);
            } catch (e) {
                alert('无效的Base64编码格式');
            }
        }

        // 复制结果
        function copyResult(id) {
            const textarea = document.getElementById(id);
            textarea.select();
            document.execCommand('copy');
            alert('结果已复制到剪贴板');
        }


        function unicodeToText() {
            try {
                const input = document.getElementById('unicode-input').value
                    .replace(/\\u([0-9a-fA-F]{4})/g, (_, code) => 
                        String.fromCharCode(parseInt(code, 16))
                    );
                document.getElementById('unicode-result').value = input;
            } catch (e) {
                alert('无效的Unicode转义格式');
            }
        }

        // 新增：颜色转换函数
        function convertColor() {
            const input = document.getElementById('color-input').value.trim().toLowerCase();
            if (!input) { alert('请输入颜色值'); return; }

            try {
                // 统一转换为RGB值
                const temp = document.createElement('div');
                temp.style.color = input;
                document.body.appendChild(temp);
                const rgbText = getComputedStyle(temp).color;
                document.body.removeChild(temp);
                
                // 解析RGB值
                const [r, g, b] = rgbText.match(/\d+/g).map(Number);
                
                // 转换为十六进制
                const hex = `#${[r, g, b].map(c => 
                    c.toString(16).padStart(2, '0')
                ).join('')}`;
                
                // 转换为HSL
                const rNorm = r / 255, gNorm = g / 255, bNorm = b / 255;
                const max = Math.max(rNorm, gNorm, bNorm), min = Math.min(rNorm, gNorm, bNorm);
                let h = 0, s = 0, l = (max + min) / 2;

                if (max !== min) {
                    const d = max - min;
                    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                    switch(max) {
                        case rNorm: h = (gNorm - bNorm) / d + (gNorm < bNorm ? 6 : 0); break;
                        case gNorm: h = (bNorm - rNorm) / d + 2; break;
                        case bNorm: h = (rNorm - gNorm) / d + 4; break;
                    }
                    h /= 6;
                }
                
                // 输出结果
                document.getElementById('color-hex').value = hex;
                document.getElementById('color-hex-preview').style.backgroundColor = hex;
                document.getElementById('color-rgb').value = `rgb(${r}, ${g}, ${b})`;
                document.getElementById('color-hsl').value = 
                    `hsl(${Math.round(h*360)}, ${Math.round(s*100)}%, ${Math.round(l*100)}%)`;
            } catch (e) {
                alert('无效的颜色格式');
            }
        }

        // 新增：时间戳转换函数
        function timestampToDate() {
            const input = document.getElementById('timestamp-input').value;
            if (!input) { alert('请输入时间戳'); return; }
            
            const ts = input.length === 10 ? input * 1000 : input * 1; // 自动识别秒/毫秒
            const date = new Date(ts);
            if (isNaN(date.getTime())) {
                alert('无效的时间戳');
                return;
            }
            document.getElementById('timestamp-result').value = 
                `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')} ` +
                `${String(date.getHours()).padStart(2,'0')}:${String(date.getMinutes()).padStart(2,'0')}:${String(date.getSeconds()).padStart(2,'0')}`;
        }

        function dateToTimestamp() {
            document.getElementById('timestamp-result').value = Date.now();
        }
function strToUpper() {
            const input = document.getElementById('string-input').value;
            document.getElementById('string-result').value = input.toUpperCase();
        }

        function strToLower() {
            const input = document.getElementById('string-input').value;
            document.getElementById('string-result').value = input.toLowerCase();
        }

        function strCapitalize() {
            const input = document.getElementById('string-input').value;
            document.getElementById('string-result').value = input
                .toLowerCase()
                .split(' ')
                .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                .join(' ');
        }

        function strTrim() {
            const input = document.getElementById('string-input').value;
            document.getElementById('string-result').value = input.trim();
        }

        function strTrimAll() {
            const input = document.getElementById('string-input').value;
            document.getElementById('string-result').value = input.replace(/\s+/g, '');
        }

        function strReverse() {
            const input = document.getElementById('string-input').value;
            document.getElementById('string-result').value = [...input].reverse().join('');
        }

        // 新增：正则表达式测试函数
        function testRegex() {
            const pattern = document.getElementById('regex-pattern').value;
            const flags = document.getElementById('regex-flags').value;
            const input = document.getElementById('regex-input').value;
            const resultEl = document.getElementById('regex-result');

            if (!pattern || !input) {
                resultEl.innerHTML = '请输入正则表达式和测试字符串';
                return;
            }

            try {
                const regex = new RegExp(pattern, flags);
                const matches = [...input.matchAll(regex)];
                
                if (matches.length === 0) {
                    resultEl.innerHTML = '无匹配结果';
                    return;
                }

                let html = `<strong>匹配结果（共${matches.length}处）：</strong><br>`;
                matches.forEach((match, index) => {
                    html += `<div>匹配${index+1}：<br>`;
                    html += `内容：${match[0]}<br>`;
                    html += `索引：${match.index}<br>`;
                    if (match.length > 1) {
                        html += `分组：${match.slice(1).join(' | ')}<br>`;
                    }
                    html += '</div>';
                });
                resultEl.innerHTML = html;
            } catch (e) {
                resultEl.innerHTML = `正则表达式错误：${e.message}`;
            }
        }

        // 新增：JSON格式化函数
        function formatJSON() {
            const input = document.getElementById('json-input').value;
            const resultEl = document.getElementById('json-result');

            try {
                const parsed = JSON.parse(input);
                const formatted = JSON.stringify(parsed, null, 4);
                resultEl.innerHTML = `<pre>${formatted}</pre>`;
                resultEl.classList.remove('json-error');
            } catch (e) {
                resultEl.innerHTML = `JSON格式错误：${e.message}`;
                resultEl.classList.add('json-error');
            }
        }

        // 新增：Markdown预览函数
        function previewMarkdown() {
            const input = document.getElementById('markdown-input').value;
            const previewEl = document.getElementById('markdown-preview');
            previewEl.innerHTML = marked.parse(input);
        }
        // 新增功能函数
        // 11. CSV转JSON
        function csvToJson() {
            const input = document.getElementById('csv-input').value.trim();
            const delimiter = document.getElementById('csv-delimiter').value;
            const resultEl = document.getElementById('csv-result');

            if (!input) {
                resultEl.value = '请输入CSV内容';
                return;
            }

            try {
                const lines = input.split('\n').filter(line => line.trim() !== '');
                const headers = lines[0].split(delimiter);
                const jsonArray = [];

                for (let i = 1; i < lines.length; i++) {
                    const values = lines[i].split(delimiter);
                    const obj = {};
                    headers.forEach((header, index) => {
                        obj[header.trim()] = values[index] ? values[index].trim() : '';
                    });
                    jsonArray.push(obj);
                }

                resultEl.value = JSON.stringify(jsonArray, null, 4);
            } catch (e) {
                resultEl.value = `转换失败：${e.message}`;
            }
        }

        // 12. 代码高亮
        function highlightCode() {
            const code = document.getElementById('code-input').value;
            const lang = document.getElementById('code-language').value;
            const resultEl = document.getElementById('code-result');

            if (!code) {
                resultEl.innerHTML = '请输入代码内容';
                return;
            }

            // 使用Prism.js高亮代码
            const highlighted = Prism.highlight(code, Prism.languages[lang], lang);
            resultEl.innerHTML = `<pre><code class="language-${lang}">${highlighted}</code></pre>`;
        }

        // 13. URL参数解析
        function parseUrlParams() {
            const url = document.getElementById('urlparam-input').value.trim();
            const resultEl = document.getElementById('urlparam-result');

            if (!url) {
                resultEl.innerHTML = '请输入完整URL';
                return;
            }

            try {
                const urlObj = new URL(url);
                const params = new URLSearchParams(urlObj.search);
                let html = '<strong>解析结果：</strong><br>';

                if (params.size === 0) {
                    html += '无查询参数';
                } else {
                    for (const [key, value] of params.entries()) {
                        html += `<div class="param-item"><strong>${key}</strong>: ${value}</div>`;
                    }
                }

                resultEl.innerHTML = html;
            } catch (e) {
                resultEl.innerHTML = `无效的URL格式：${e.message}`;
            }
        }
    </script>
</body>
</html>
    